<!DOCTYPE html>
<html lang="en">
  <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Implementing a block widget - CKEditor 5 Documentation</title>
    <meta name="description" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <meta name="twitter:card" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <meta name="twitter:site" content="@ckeditor">
    <meta property="og:title" content="Implementing a block widget - CKEditor 5 Documentation">
    <meta property="og:description" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ckeditor.com/docs/ckeditor5/latest/framework/guides/tutorials/implementing-a-block-widget.html">
    <meta property="DC.language" content="en">
    <meta property="DC.publisher" content="CKSource">
    <meta property="DC.creator" content="CKEditor">
    <meta property="DC.title" content="Implementing a block widget - CKEditor 5 Documentation">
    <meta property="DC.format" content="text/html">
    <meta property="DC.type" content="Text">
    <meta property="DC.description" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <link rel="canonical" href="https://ckeditor.com/docs/ckeditor5/latest/framework/guides/tutorials/implementing-a-block-widget.html">
    <link rel="icon" type="image/png" href="../../../assets/img/favicons/16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="../../../assets/img/favicons/32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../../assets/img/favicons/96x96.png" sizes="96x96">
    <link rel="apple-touch-icon" type="image/png" href="../../../assets/img/favicons/200x200.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
    <link rel="stylesheet" href="../../../../../assets/0.22.0/css/styles.css" type="text/css" media="all">
    <link rel="stylesheet" href="../../../assets/styles.css" type="text/css">
    <link rel="stylesheet" href="../../../snippets/framework/tutorials/block-widget/snippet.css" type="text/css">
    <link rel="stylesheet" href="../../../assets/snippet-styles.css" type="text/css">
    <script>
      ( function() {
      	'use strict';
      	// Set up global variables;
      	if ( !window.umebrto ) {
      		window.umberto = {};
      	}
      	window.umberto.relativeAppPath = "../../../../../assets/0.22.0/scripts"
      
      	// Add app script
      	var el = document.createElement( 'script' );
      	el.setAttribute( 'async', 'async' );
      	el.setAttribute( 'defer', 'defer' );
      	if ( typeof Symbol === 'function' && typeof Symbol() === 'symbol' ) {
      		el.src = "../../../../../assets/0.22.0/scripts/app.js";
      	} else {
      		el.src = "../../../../../assets/0.22.0/scripts/app-polyfill.js";
      	}
      	document.getElementsByTagName( 'head' )[ 0 ].appendChild( el );
      
      	// Changing documentation theme enable it via `localStorage.setItem( 'theme', 'theme-dark' )`
      	if ( localStorage.getItem( 'theme' ) === 'theme-dark' ) {
      		document.getElementsByTagName( 'html' )[ 0 ].classList.add( 'theme-dark' );
      	}
      } )();
    </script>
    <script>if ( ["ckeditor5.github.io"].indexOf( location.hostname ) !== -1 ) {
      	function pageView() {
      		ga( 'send', 'pageview', location.pathname + location.search + location.hash );
      	}
      
      	(function( i, s, o, g, r, a, m ) {
      		i[ 'GoogleAnalyticsObject' ] = r;
      		i[ r ] = i[ r ] || function() {
      				(i[ r ].q = i[ r ].q || []).push( arguments )
      			}, i[ r ].l = 1 * new Date();
      		a = s.createElement( o ),
      			m = s.getElementsByTagName( o )[ 0 ];
      		a.async = 1;
      		a.src = g;
      		m.parentNode.insertBefore( a, m )
      	})( window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga' );
      
      	ga( 'create', {"trackingId":"UA-271067-19","cookieDomain":"ckeditor5.github.io"} );
      
      	pageView();
      
      	window.addEventListener( 'hashchange', pageView );
      }
    </script>
  </head>
  <body>
    <header class="top" data-project="ckeditor5">
      <div class="header__main">
        <div class="header__main-rwd-button"><a href="#"><span></span><span></span><span></span></a></div>
        <div class="header__main-title"><a class="header__main-title-home" href="../../../../../index.html">CKEditor Ecosystem Documentation</a></div>
        <div class="top__search">
          <input class="top__search__box" type="text" id="docsearch_input" placeholder="Search in CKEditor 5">
          <div class="top__search__button"><img src="../../../../../assets/0.22.0/img/loupe.svg" alt="Search"></div>
        </div>
      </div>
      <div class="header__sub">
        <ul class="top__menu">
          <li class="top__menu-project-logo"><a href="../../../index.html">CKEditor 5</a></li>
          <li><a href="../../../builds/index.html">Builds</a></li>
          <li><a class="top__menu__item--active" href="../../index.html">Framework</a></li>
          <li><a href="../../../examples/index.html">Examples</a></li>
          <li><a href="../../../features/index.html">Features</a></li>
          <li><a class="top__menu__api" href="../../../api/index.html">API</a></li>
          <li><a class="top__menu-github-link" href="https://github.com/ckeditor/ckeditor5" target="_blank" title="CKEditor 5 on GitHub."><svg viewbox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a></li>
        </ul>
      </div>
      <div class="header__menu-rwd">
        <ul class="header__menu-rwd__projects">
          <li data-project="ckeditor5"><a href="../../../../latest/index.html">CKEditor 5
              <ul class="tree header__menu-rwd__projects-pages">
                <li data-group="builds"><a href="../../../builds/index.html">Builds</a>
                  <!-- Display subpages for active project.-->
                </li>
                <li data-group="framework"><a href="../../index.html">Framework</a>
                  <!-- Display subpages for active project.-->
                  <ul class="header__menu-rwd__projects-subpages">
                            <li>
                              <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Guides</span></div>
                              <ul class="tree__item-nested-list">
                                    <li><a href="../overview.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Overview</span></div></a></li>
                                    <li><a href="../quick-start.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Quick start</span></div></a></li>
                                    <li><a href="../creating-simple-plugin.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Creating a simple plugin</span></div></a></li>
                                    <li><a href="../development-tools.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Development tools</span></div></a></li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Architecture</span></div>
                                      <ul class="tree__item-nested-list">
                                            <li><a href="../architecture/intro.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Introduction</span></div></a></li>
                                            <li><a href="../architecture/core-editor-architecture.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Core editor architecture</span></div></a></li>
                                            <li><a href="../architecture/editing-engine.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Editing engine</span></div></a></li>
                                            <li><a href="../architecture/ui-library.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">UI library</span></div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Tutorials</span></div>
                                      <ul class="tree__item-nested-list">
                                            <li><a href>
                                                <div class="tree__item__wrapper tree__item__wrapper--active"><span class="tree__item--guide tree__item__text">Implementing a block widget</span></div></a></li>
                                            <li><a href="implementing-an-inline-widget.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Implementing an inline widget</span></div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Deep dive</span></div>
                                      <ul class="tree__item-nested-list">
                                            <li><a href="../deep-dive/clipboard.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Clipboard</span></div></a></li>
                                            <li><a href="../deep-dive/upload-adapter.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Custom upload adapter</span></div></a></li>
                                            <li><a href="../deep-dive/observables.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Observables</span></div></a></li>
                                            <li><a href="../deep-dive/schema.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Schema</span></div></a></li>
                                            <li>
                                              <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">User interface</span></div>
                                              <ul class="tree__item-nested-list">
                                                    <li><a href="../deep-dive/ui/theme-customization.html">
                                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Theme customization</span></div></a></li>
                                                    <li><a href="../deep-dive/ui/external-ui.html">
                                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Thirdâ€“party UI</span></div></a></li>
                                                    <li><a href="../deep-dive/ui/document-editor.html">
                                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Document editor</span></div></a></li>
                                                    <li><a href="../deep-dive/ui/custom-editor-creator.html">
                                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Creating custom editor</span></div></a></li>
                                              </ul>
                                            </li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Contributing</span></div>
                                      <ul class="tree__item-nested-list">
                                            <li><a href="../contributing/contributing.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Contributing</span></div></a></li>
                                            <li><a href="../contributing/development-environment.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Development environment</span></div></a></li>
                                            <li><a href="../contributing/testing-environment.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Testing environment</span></div></a></li>
                                            <li><a href="../contributing/git-commit-message-convention.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Git commit message convention</span></div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Support</span></div>
                                      <ul class="tree__item-nested-list">
                                            <li><a href="../support/browser-compatibility.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Browser compatibility</span></div></a></li>
                                            <li><a href="../support/license-and-legal.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">License and legal</span></div></a></li>
                                            <li><a href="../support/getting-support.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Getting support</span></div></a></li>
                                            <li><a href="../support/reporting-issues.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Reporting issues</span></div></a></li>
                                            <li><a href="../support/error-codes.html">
                                                <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Error codes</span></div></a></li>
                                      </ul>
                                    </li>
                              </ul>
                            </li>
                  </ul>
                </li>
                <li data-group="examples"><a href="../../../examples/index.html">Examples</a>
                  <!-- Display subpages for active project.-->
                </li>
                <li data-group="features"><a href="../../../features/index.html">Features</a>
                  <!-- Display subpages for active project.-->
                </li>
                <li data-group="api-reference"><a href="../../../api/index.html">API</a>
                  <!-- Display subpages for active project.-->
                </li>
              </ul></a></li>
        </ul>
      </div>
    </header>
    <main class="main">
      <section class="main__content formatted">
        <div class="main__content-inner">
          <div class="github-contrib"><a href="https://github.com/ckeditor/ckeditor5/blob/master/docs/framework/guides/tutorials/implementing-a-block-widget.md" title="Contribute to this guide"><img src="../../../../../assets/0.22.0/img/edit.svg" alt="Contribute to this guide"></a><a href="https://github.com/ckeditor/ckeditor5/issues/new" title="Report an issue"><img src="../../../../../assets/0.22.0/img/exclamation-circle.svg" alt="Report an issue"></a>
          </div>
          <div class="rwd-breadcrumbs"><a href="../../../../../index.html">Home</a><span class="rwd-breadcrumbs__separator">/</span><a href="../../../index.html">CKEditor 5</a><span class="rwd-breadcrumbs__separator">/</span><a href="../../index.html">Framework</a>
          </div>
          <h1 class="main__content-title"><img src="../../../../../assets/0.22.0/img/book.svg" alt="guide">Implementing a block widget
          </h1><nav class="secondary-navigation"><h3>Table of contents</h3><ol><li><a href="#before-you-start">Before you start</a></li><li><a href="#lets-start">Let&#x2019;s start</a></li><li><a href="#plugin-structure">Plugin structure</a></li><li><a href="#the-model-and-the-view-layers">The model and the view layers</a><ol><li><a href="#defining-the-schema">Defining the schema</a></li><li><a href="#defining-converters">Defining converters</a></li><li><a href="#whats-in-the-model">What&#x2019;s in the model?</a></li><li><a href="#behavior-before-widgetizing-simple-box">Behavior before &#x201C;widgetizing&#x201D; simple box</a></li><li><a href="#making-simple-box-a-widget">Making simple box a widget</a></li><li><a href="#behavior-after-widgetizing-simple-box">Behavior after &#x201C;widgetizing&#x201D; simple box</a></li></ol></li><li><a href="#creating-a-command">Creating a command</a></li><li><a href="#creating-a-button">Creating a button</a></li><li><a href="#demo">Demo</a></li><li><a href="#full-source-code">Full source code</a></li></ol></nav>
<p>In this tutorial, you will learn how to implement a more complex CKEditor 5 plugin. We will build a &#x201C;Simple box&#x201D; feature which will allow the user to insert a custom box with a title and body fields into the document. We will use the widget utils and work with the model-view conversion in order to properly set up the behavior of this feature. Later on, we will create a UI which will allow inserting new simple boxes into the document via the toolbar button.</p>
<div class="info-box notice"><p>If you want to see the final product of this tutorial before you plunge in, check out the <a href="#demo">demo</a>.</p></div>
<!-- TODO: and allow controlling simple box properties such as alignment and width. -->
<h2 id="before-you-start"><a class="headerlink" href="#before-you-start">#</a> Before you start</h2>
<p>While it is not strictly necessary to read the <a href="../quick-start.html">Quick start</a> guide before going through this tutorial, it may help you to get more comfortable with CKEditor 5 framework before you will dive into this tutorial.</p>
<p>We will also reference various parts of the <a href="../architecture/intro.html">CKEditor 5 architecture</a> section as we go. While reading them is not necessary to finish this tutorial, we recommend reading those guides at some point to get a better understanding of the mechanisms used in this tutorial.</p>
<h2 id="lets-start"><a class="headerlink" href="#lets-start">#</a> Let&#x2019;s start</h2>
<p>This guide assumes that you are familiar with npm and your project uses npm already. If not, see the <a href="https://docs.npmjs.com/getting-started/what-is-npm" target="_blank" rel="noopener">npm documentation</a> or call <code>npm init</code> in an empty directory and keep your fingers crossed.</p>
<p>First, install packages needed to build and set up a basic CKEditor 5 instance.</p>
<pre class="highlight"><code class="bash">npm install --save \
    postcss-loader \
    raw-loader \
    style-loader \
    webpack@4 \
    webpack-cli@3 \
    @ckeditor/ckeditor5-dev-utils \
    @ckeditor/ckeditor5-editor-classic \
    @ckeditor/ckeditor5-essentials \
    @ckeditor/ckeditor5-paragraph \
    @ckeditor/ckeditor5-heading \
    @ckeditor/ckeditor5-list \
    @ckeditor/ckeditor5-basic-styles \
    @ckeditor/ckeditor5-theme-lark
</code></pre>
<p>Create minimal webpack configuration:</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-meta">
&apos;use strict&apos;</span>;

<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>( <span class="hljs-string">&apos;path&apos;</span> );
<span class="hljs-keyword">const</span> { styles } = <span class="hljs-built_in">require</span>( <span class="hljs-string">&apos;@ckeditor/ckeditor5-dev-utils&apos;</span> );

<span class="hljs-built_in">module</span>.exports = {
    <span class="hljs-attr">entry</span>: <span class="hljs-string">&apos;./app.js&apos;</span>,

    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">path</span>: path.resolve( __dirname, <span class="hljs-string">&apos;dist&apos;</span> ),
        <span class="hljs-attr">filename</span>: <span class="hljs-string">&apos;bundle.js&apos;</span>
    },

    <span class="hljs-attr">module</span>: {
        <span class="hljs-attr">rules</span>: [
            {
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.svg$/</span>,
                <span class="hljs-attr">use</span>: [ <span class="hljs-string">&apos;raw-loader&apos;</span> ]
            },
            {
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,
                <span class="hljs-attr">use</span>: [
                    {
                        <span class="hljs-attr">loader</span>: <span class="hljs-string">&apos;style-loader&apos;</span>,
                        <span class="hljs-attr">options</span>: {
                            <span class="hljs-attr">singleton</span>: <span class="hljs-literal">true</span>
                        }
                    },
                    {
                        <span class="hljs-attr">loader</span>: <span class="hljs-string">&apos;postcss-loader&apos;</span>,
                        <span class="hljs-attr">options</span>: styles.getPostCssConfig( {
                            <span class="hljs-attr">themeImporter</span>: {
                                <span class="hljs-attr">themePath</span>: <span class="hljs-built_in">require</span>.resolve( <span class="hljs-string">&apos;@ckeditor/ckeditor5-theme-lark&apos;</span> )
                            },
                            <span class="hljs-attr">minify</span>: <span class="hljs-literal">true</span>
                        } )
                    },
                ]
            }
        ]
    },

    <span class="hljs-comment">// Useful for debugging.</span>
    devtool: <span class="hljs-string">&apos;source-map&apos;</span>,

    <span class="hljs-comment">// By default webpack logs warnings if the bundle is bigger than 200kb.</span>
    performance: { <span class="hljs-attr">hints</span>: <span class="hljs-literal">false</span> }
};
</code></pre>
<p>Create your project&#x2019;s entry point:</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// app.js</span>

<span class="hljs-keyword">import</span> ClassicEditor <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-editor-classic/src/classiceditor&apos;</span>;
<span class="hljs-keyword">import</span> Essentials <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-essentials/src/essentials&apos;</span>;
<span class="hljs-keyword">import</span> Paragraph <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-paragraph/src/paragraph&apos;</span>;
<span class="hljs-keyword">import</span> Heading <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-heading/src/heading&apos;</span>;
<span class="hljs-keyword">import</span> List <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-list/src/list&apos;</span>;
<span class="hljs-keyword">import</span> Bold <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-basic-styles/src/bold&apos;</span>;
<span class="hljs-keyword">import</span> Italic <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-basic-styles/src/italic&apos;</span>;

ClassicEditor
    .create( <span class="hljs-built_in">document</span>.querySelector( <span class="hljs-string">&apos;#editor&apos;</span> ), {
        <span class="hljs-attr">plugins</span>: [ Essentials, Paragraph, Heading, List, Bold, Italic ],
        <span class="hljs-attr">toolbar</span>: [ <span class="hljs-string">&apos;heading&apos;</span>, <span class="hljs-string">&apos;bold&apos;</span>, <span class="hljs-string">&apos;italic&apos;</span>, <span class="hljs-string">&apos;numberedList&apos;</span>, <span class="hljs-string">&apos;bulletedList&apos;</span> ]
    } )
    .then( <span class="hljs-function"><span class="hljs-params">editor</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;Editor was initialized&apos;</span>, editor );

        <span class="hljs-comment">// Expose for playing in the console.</span>
        <span class="hljs-built_in">window</span>.editor = editor;
    } )
    .catch( <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.error( error.stack );
    } );
</code></pre>
<p>And an <code>index.html</code> page:</p>
<pre class="highlight"><code class="html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CKEditor 5 Framework &#x2013; Implementing a simple widget<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;editor&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Editor content goes here.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;dist/bundle.js&quot;</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>Finally, let&#x2019;s build your project and see if everything worked well by opening the index page in your browser:</p>
<pre class="highlight"><code class>p@m /workspace/creating-a-plugin&gt; ./node_modules/.bin/webpack --mode development
Hash: a4a7cf092b8d69199848
Version: webpack 4.28.4
Time: 5467ms
Built at: 2019-01-15 10:49:01
        Asset      Size  Chunks                    Chunk Names
    bundle.js  3.52 MiB    main  [emitted]  [big]  main
bundle.js.map   3.2 MiB    main  [emitted]         main
Entrypoint main [big] = bundle.js bundle.js.map
[./app.js] 824 bytes {main} [built]
[./node_modules/webpack/buildin/global.js] (webpack)/buildin/global.js 472 bytes {main} [built]
[./node_modules/webpack/buildin/harmony-module.js] (webpack)/buildin/harmony-module.js 573 bytes {main} [built]
    + 904 hidden modules
</code></pre>
<p>You should see a CKEditor 5 instance like this:</p>
<p><a href="../../../assets/img/tutorial-implementing-a-widget-1.png" data-lightbox="true"><img src="../../../assets/img/tutorial-implementing-a-widget-1.png" alt="Screenshot of a classic editor initialized from source."></a></p>
<h2 id="plugin-structure"><a class="headerlink" href="#plugin-structure">#</a> Plugin structure</h2>
<p>Once the editor is up and running we can start implementing the plugin. All the code of a plugin can be kept in a single file, however, we recommend splitting its &#x201C;editing&#x201D; and &#x201C;UI&#x201D; layers and creating a master plugin which loads both. This way, we ensure better separation of concerns and allow recomposing the features (e.g. picking the editing part of an existing feature but writing your own UI for it). All official CKEditor 5 plugins follow this pattern.</p>
<p>Additionally, we will split code of commands, buttons and other &#x201C;self-contained&#x201D; components to separate files as well. In order to not mix up these files with your project&#x2019;s <code>app.js</code> and <code>webpack.config.js</code> files, let&#x2019;s create this directory structure:</p>
<pre class="highlight"><code class>&#x251C;&#x2500;&#x2500; app.js
&#x251C;&#x2500;&#x2500; dist
&#x2502;&#xA0;&#xA0; &#x251C;&#x2500;&#x2500; bundle.js
&#x2502;&#xA0;&#xA0; &#x2514;&#x2500;&#x2500; bundle.js.map
&#x251C;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; node_modules
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; simplebox
&#x2502;&#xA0;&#xA0; &#x251C;&#x2500;&#x2500; simplebox.js
&#x2502;&#xA0;&#xA0; &#x251C;&#x2500;&#x2500; simpleboxediting.js
&#x2502;&#xA0;&#xA0; &#x2514;&#x2500;&#x2500; simpleboxui.js
&#x2502;
&#x2502;&#xA0;&#xA0; ... the rest of plugin files go here as well
&#x2502;
&#x2514;&#x2500;&#x2500; webpack.config.js
</code></pre>
<p>Let&#x2019;s now define the 3 plugins.</p>
<p>First, the master (glue) plugin. Its role is to simply load the &#x201C;editing&#x201D; and &#x201C;UI&#x201D; parts.</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/simplebox.js</span>

<span class="hljs-keyword">import</span> SimpleBoxEditing <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./simpleboxediting&apos;</span>;
<span class="hljs-keyword">import</span> SimpleBoxUI <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./simpleboxui&apos;</span>;
<span class="hljs-keyword">import</span> Plugin <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/plugin&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBox</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> requires() {
        <span class="hljs-keyword">return</span> [ SimpleBoxEditing, SimpleBoxUI ];
    }
}
</code></pre>
<p>Now, the remaining two plugins:</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/simpleboxui.js</span>

<span class="hljs-keyword">import</span> Plugin <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/plugin&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxUI</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxUI#init() got called&apos;</span> );
    }
}
</code></pre>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/simpleboxediting.js</span>

<span class="hljs-keyword">import</span> Plugin <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/plugin&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxEditing</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxEditing#init() got called&apos;</span> );
    }
}
</code></pre>
<p>Finally, we need to load the <code>SimpleBox</code> plugin in our <code>app.js</code> file:</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// app.js</span>

<span class="hljs-keyword">import</span> ClassicEditor <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-editor-classic/src/classiceditor&apos;</span>;
<span class="hljs-keyword">import</span> Essentials <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-essentials/src/essentials&apos;</span>;
<span class="hljs-keyword">import</span> Paragraph <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-paragraph/src/paragraph&apos;</span>;
<span class="hljs-keyword">import</span> Heading <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-heading/src/heading&apos;</span>;
<span class="hljs-keyword">import</span> List <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-list/src/list&apos;</span>;
<span class="hljs-keyword">import</span> Bold <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-basic-styles/src/bold&apos;</span>;
<span class="hljs-keyword">import</span> Italic <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-basic-styles/src/italic&apos;</span>;

<span class="hljs-keyword">import</span> SimpleBox <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./simplebox/simplebox&apos;</span>;                                 <span class="hljs-comment">// ADDED</span>

ClassicEditor
    .create( <span class="hljs-built_in">document</span>.querySelector( <span class="hljs-string">&apos;#editor&apos;</span> ), {
        <span class="hljs-attr">plugins</span>: [
            Essentials, Paragraph, Heading, List, Bold, Italic,
            SimpleBox                                                          <span class="hljs-comment">// ADDED</span>
        ],
        <span class="hljs-attr">toolbar</span>: [ <span class="hljs-string">&apos;heading&apos;</span>, <span class="hljs-string">&apos;bold&apos;</span>, <span class="hljs-string">&apos;italic&apos;</span>, <span class="hljs-string">&apos;numberedList&apos;</span>, <span class="hljs-string">&apos;bulletedList&apos;</span> ]
    } )
    .then( <span class="hljs-function"><span class="hljs-params">editor</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;Editor was initialized&apos;</span>, editor );

        <span class="hljs-comment">// Expose for playing in the console.</span>
        <span class="hljs-built_in">window</span>.editor = editor;
    } )
    .catch( <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.error( error.stack );
    } );
</code></pre>
<p>Rebuild your project, refresh the browser and you should see that the <code>SimpleBoxEditing</code> and <code>SmpleBoxUI</code> plugins were loaded:</p>
<p><a href="../../../assets/img/tutorial-implementing-a-widget-2.png" data-lightbox="true"><img src="../../../assets/img/tutorial-implementing-a-widget-2.png" alt="Screenshot of a classic editor initialized from source with the SimpleBoxEditing#init() got called and SimpleBoxUI#init() got called messages on the console."></a></p>
<h2 id="the-model-and-the-view-layers"><a class="headerlink" href="#the-model-and-the-view-layers">#</a> The model and the view layers</h2>
<p>CKEditor 5 implements an MVC architecture and its custom data model, while still being a tree structure, does not map to the DOM 1:1. You can think about the model as about an even more semantical representation of the editor content, while the DOM is one of its possible representations.</p>
<div class="info-box notice"><p>Read more about the <a href="../architecture/editing-engine.html#overview">editing engine architecture</a>.</p></div>
<p>Since our simple box feature is meant to be a box with a title and description fields, let&#x2019;s define its model representation like this:</p>
<pre class="highlight"><code class="html"><span class="hljs-tag">&lt;<span class="hljs-name">simpleBox</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">simpleBoxTitle</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">simpleBoxTitle</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">simpleBoxDescription</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">simpleBoxDescription</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">simpleBox</span>&gt;</span>
</code></pre>
<h3 id="defining-the-schema"><a class="headerlink" href="#defining-the-schema">#</a> Defining the schema</h3>
<p>We need to start with defining the model&#x2019;s schema. We need to define there 3 elements and their types and allowed parent/children.</p>
<div class="info-box notice"><p>Read more about the <a href="../architecture/editing-engine.html#schema">schema</a>.</p></div>
<p>Let&#x2019;s update the <code>SimpleBoxEditing</code> plugin with this definition.</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/simpleboxediting.js</span>

<span class="hljs-keyword">import</span> Plugin <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/plugin&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxEditing</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxEditing#init() got called&apos;</span> );

        <span class="hljs-keyword">this</span>._defineSchema();                                                  <span class="hljs-comment">// ADDED</span>
    }

    _defineSchema() {                                                          <span class="hljs-comment">// ADDED</span>
        <span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">this</span>.editor.model.schema;

        schema.register( <span class="hljs-string">&apos;simpleBox&apos;</span>, {
            <span class="hljs-comment">// Behaves like a self-contained object (e.g. an image).</span>
            isObject: <span class="hljs-literal">true</span>,

            <span class="hljs-comment">// Allow in places where other blocks are allowed (e.g. directly in the root).</span>
            allowWhere: <span class="hljs-string">&apos;$block&apos;</span>
        } );

        schema.register( <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>, {
            <span class="hljs-comment">// Cannot be split or left by the caret.</span>
            isLimit: <span class="hljs-literal">true</span>,

            <span class="hljs-attr">allowIn</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,

            <span class="hljs-comment">// Allow content which is allowed in blocks (i.e. text with attributes).</span>
            allowContentOf: <span class="hljs-string">&apos;$block&apos;</span>
        } );

        schema.register( <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>, {
            <span class="hljs-comment">// Cannot be split or left by the caret.</span>
            isLimit: <span class="hljs-literal">true</span>,

            <span class="hljs-attr">allowIn</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,

            <span class="hljs-comment">// Allow content which is allowed in the root (e.g. paragraphs).</span>
            allowContentOf: <span class="hljs-string">&apos;$root&apos;</span>
        } );
    }
}
</code></pre>
<p>Defining the schema will not have any effect on the editor just yet. It is information which can be used by plugins and the editor engine to understand how actions like pressing the <kbd>Enter</kbd> key, clicking on an element, typing text, inserting an image, etc. should behave.</p>
<p>For the simple box plugin to start doing anything we need to define model-view converters. Let&#x2019;s do that!</p>
<h3 id="defining-converters"><a class="headerlink" href="#defining-converters">#</a> Defining converters</h3>
<p>Converters tell the editor how to convert the view to the model (e.g. when loading the data to the editor or handling pasted content) and how to render the model to the view (for editing purposes, or when retrieving editor data).</p>
<div class="info-box notice"><p>Read more about the <a href="../architecture/editing-engine.html#conversion">model-view conversion</a>.</p></div>
<p>This is the moment when we need to think about how we want to render the <code>&lt;simpleBox&gt;</code> element and its children to the DOM (what user will see) and to the data. CKEditor 5 allows converting the model to a different structure for editing purposes and a different one to be stored as &#x201C;data&#x201D; or exchanged with other applications when copy-pasting the content. However, for simplicity, let&#x2019;s use the same representation in both pipelines for now.</p>
<p>The structure in the view that we want to achieve:</p>
<pre class="highlight"><code class="html"><span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;simple-box&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;simple-box-title&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;simple-box-description&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
</code></pre>
<p>Let&#x2019;s use the <a href="../../../api/module_engine_conversion_conversion-Conversion.html#function-elementToElement"><code>conversion.elementToElement()</code></a> method to define all the converters.</p>
<div class="info-box notice"><p>We can use this high-level two-way converters definition because we define the same converters for the <a href="../architecture/editing-engine.html#data-pipeline">data</a> and <a href="../architecture/editing-engine.html#editing-pipeline">editing</a> pipelines.</p><p>Later on we will switch to more fine-grained converters to get more control over the conversion.</p></div>
<p>We need to define converters for 3 model elements. Let&#x2019;s update the <code>SimpleBoxEditing</code> plugin with this code:</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/simpleboxediting.js</span>

<span class="hljs-keyword">import</span> Plugin <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/plugin&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxEditing</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxEditing#init() got called&apos;</span> );

        <span class="hljs-keyword">this</span>._defineSchema();
        <span class="hljs-keyword">this</span>._defineConverters();                                              <span class="hljs-comment">// ADDED</span>
    }

    _defineSchema() {
        <span class="hljs-comment">// ...</span>
    }

    _defineConverters() {                                                      <span class="hljs-comment">// ADDED</span>
        <span class="hljs-keyword">const</span> conversion = <span class="hljs-keyword">this</span>.editor.conversion;

        conversion.elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;section&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box&apos;</span>
            }
        } );

        conversion.elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;h1&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-title&apos;</span>
            }
        } );

        conversion.elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;div&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-description&apos;</span>
            }
        } );
    }
}
</code></pre>
<p>Once we have converters, we can try to see the simple box in action. We did not define yet a way to insert a new simple box into the document, so let&#x2019;s load it via the editor data. In order to do that, we need to modify the <code>index.html</code> file:</p>
<pre class="highlight"><code class="html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CKEditor 5 Framework &#x2013; Implementing a simple widget<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
            <span class="hljs-selector-class">.simple-box</span> {
                <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
                <span class="hljs-attribute">margin</span>: <span class="hljs-number">1em</span> <span class="hljs-number">0</span>;

                <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>( 0, 0, 0, 0.1 );
                <span class="hljs-attribute">border</span>: solid <span class="hljs-number">1px</span> <span class="hljs-built_in">hsl</span>(0, 0%, 77%);
                <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">2px</span>;
            }

            <span class="hljs-selector-class">.simple-box-title</span>, <span class="hljs-selector-class">.simple-box-description</span> {
                <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
                <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;

                <span class="hljs-attribute">background</span>: <span class="hljs-number">#FFF</span>;
                <span class="hljs-attribute">border</span>: solid <span class="hljs-number">1px</span> <span class="hljs-built_in">hsl</span>(0, 0%, 77%);
            }

            <span class="hljs-selector-class">.simple-box-title</span> {
                <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">10px</span>;
            }
        </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;editor&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This is a simple box:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;simple-box&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;simple-box-title&quot;</span>&gt;</span>Box title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;simple-box-description&quot;</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>The description goes here.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>It can contain lists,<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>and other block elements like headings.<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;dist/bundle.js&quot;</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>Rebuild your project and voila &#x2014; that&#x2019;s your first simple box instance:</p>
<p><a href="../../../assets/img/tutorial-implementing-a-widget-3.png" data-lightbox="true"><img src="../../../assets/img/tutorial-implementing-a-widget-3.png" alt="Screenshot of a classic editor with an instance of a simple box inside."></a></p>
<h3 id="whats-in-the-model"><a class="headerlink" href="#whats-in-the-model">#</a> What&#x2019;s in the model?</h3>
<p>The HTML that you have added to the <code>index.html</code> file is your editor&#x2019;s data. This is what <code>editor.getData()</code> would return. Also, for now, this also the DOM structure which is rendered by CKEditor 5&#x2019;s engine in the editable region:</p>
<p><a href="../../../assets/img/tutorial-implementing-a-widget-4.png" data-lightbox="true"><img src="../../../assets/img/tutorial-implementing-a-widget-4.png" alt="Screenshot of a DOM structure of the simple box instance &#x2013; it looks exactly like the data loaded into the editor."></a></p>
<p>However, what&#x2019;s in the model?</p>
<p>To learn that, we recommend using the official <a href="../development-tools.html#ckeditor-5-inspector">CKEditor 5 inspector</a>. Once <a href="../development-tools.html#ckeditor-5-inspector">installed</a>, you need to load it in the <code>app.js</code> file:</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// app.js</span>

<span class="hljs-keyword">import</span> ClassicEditor <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-editor-classic/src/classiceditor&apos;</span>;
<span class="hljs-keyword">import</span> Essentials <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-essentials/src/essentials&apos;</span>;
<span class="hljs-keyword">import</span> Paragraph <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-paragraph/src/paragraph&apos;</span>;
<span class="hljs-keyword">import</span> Heading <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-heading/src/heading&apos;</span>;
<span class="hljs-keyword">import</span> List <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-list/src/list&apos;</span>;
<span class="hljs-keyword">import</span> Bold <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-basic-styles/src/bold&apos;</span>;
<span class="hljs-keyword">import</span> Italic <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-basic-styles/src/italic&apos;</span>;

<span class="hljs-keyword">import</span> SimpleBox <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./simplebox/simplebox&apos;</span>;

<span class="hljs-keyword">import</span> CKEditorInspector <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-inspector&apos;</span>;                 <span class="hljs-comment">// ADDED</span>

ClassicEditor
    .create( <span class="hljs-built_in">document</span>.querySelector( <span class="hljs-string">&apos;#editor&apos;</span> ), {
        <span class="hljs-attr">plugins</span>: [
            Essentials, Paragraph, Heading, List, Bold, Italic,
            SimpleBox
        ],
        <span class="hljs-attr">toolbar</span>: [ <span class="hljs-string">&apos;heading&apos;</span>, <span class="hljs-string">&apos;bold&apos;</span>, <span class="hljs-string">&apos;italic&apos;</span>, <span class="hljs-string">&apos;numberedList&apos;</span>, <span class="hljs-string">&apos;bulletedList&apos;</span> ]
    } )
    .then( <span class="hljs-function"><span class="hljs-params">editor</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;Editor was initialized&apos;</span>, editor );

        CKEditorInspector.attach( <span class="hljs-string">&apos;editor&apos;</span>, editor );

        <span class="hljs-built_in">window</span>.editor = editor;
    } )
    .catch( <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.error( error.stack );
    } );
</code></pre>
<p>After rebuilding your project and refreshing the page you will see the inspector:</p>
<p><a href="../../../assets/img/tutorial-implementing-a-widget-4b.png" data-lightbox="true"><img src="../../../assets/img/tutorial-implementing-a-widget-4b.png" alt="Screenshot of a the simple box widget&#x2019;s structure displayed by CKEditor 5 inspector."></a></p>
<p>You will see the following HTML-like string:</p>
<pre class="highlight"><code class="html"><span class="hljs-tag">&lt;<span class="hljs-name">paragraph</span>&gt;</span>[]This is a simple box:<span class="hljs-tag">&lt;/<span class="hljs-name">paragraph</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">simpleBox</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">simpleBoxTitle</span>&gt;</span>Box title<span class="hljs-tag">&lt;/<span class="hljs-name">simpleBoxTitle</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">simpleBoxDescription</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">paragraph</span>&gt;</span>The description goes here.<span class="hljs-tag">&lt;/<span class="hljs-name">paragraph</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">listItem</span> <span class="hljs-attr">listIndent</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">listType</span>=<span class="hljs-string">&quot;bulleted&quot;</span>&gt;</span>It can contain lists,<span class="hljs-tag">&lt;/<span class="hljs-name">listItem</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">listItem</span> <span class="hljs-attr">listIndent</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">listType</span>=<span class="hljs-string">&quot;bulleted&quot;</span>&gt;</span>and other block elements like headings.<span class="hljs-tag">&lt;/<span class="hljs-name">listItem</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">simpleBoxDescription</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">simpleBox</span>&gt;</span>
</code></pre>
<p>As you can see, this structure is quite different than the HTML input/output. If you look closely, you will also notice the <code>[]</code> characters in the first paragraph &#x2014; that&#x2019;s selection position.</p>
<p>Play a bit with editor features (bold, italic, headings, lists, selection) to see how the model structure changes.</p>
<div class="info-box notice"><p>You can also use some <a href="../development-tools.html#testing-helpers">useful helpers like <code>getData()</code> and <code>setData()</code></a> to learn more about the state of the editor model or write assertions in tests.</p></div>
<h3 id="behavior-before-widgetizing-simple-box"><a class="headerlink" href="#behavior-before-widgetizing-simple-box">#</a> Behavior before &#x201C;widgetizing&#x201D; simple box</h3>
<p>It is time to check if the simple box behaves like we would like it to. You can observe the following:</p>
<ul>
<li>You can type text in the title, but pressing <kbd>Enter</kbd> will not split it and <kbd>Backspace</kbd> will not delete it entirely. That is because it was marked as an <code>isLimit</code> element in the schema.</li>
<li>You cannot apply a list in the title and cannot turn it into a heading (other than <code>&lt;h1 class=&quot;simple-box-title&quot;&gt;</code> which it is already). That is because it allows only the content that is allowed in other block elements (like paragraphs). You can, however, apply italic inside a title (because italic is allowed in other blocks).</li>
<li>The description behaves like the title, but it allows more content inside &#x2014; lists and other headings.</li>
<li>If you try to select the entire simple box instance and press <kbd>Delete</kbd>, it will be deleted as a whole. The same when you copy and paste it. That is because it was marked as an <code>isObject</code> element in the schema.</li>
<li>You cannot easily select the entire simple box instance by clicking on it. Also, the cursor pointer does not change when you hover it. In other words, it seems a bit &#x201C;dead&#x201D;. That is because we have not yet defined the view behavior yet.</li>
</ul>
<p>Pretty cool so far, right? With a very little code, you were able to define a behavior of your simple box plugin which maintains the integrity of those elements. The engine ensures that the user does not break those instances.</p>
<p>Let&#x2019;s see what else we can improve.</p>
<h3 id="making-simple-box-a-widget"><a class="headerlink" href="#making-simple-box-a-widget">#</a> Making simple box a widget</h3>
<div class="info-box notice"><p>If you are familiar with the {@link @ckeditor4 guide/dev_widgets Widget System of CKEditor 4} you will notice significant differences in how widgets are implemented in CKEditor 5.</p><p>CKEditor 4&#x2019;s implementation exposes a declarative API which controls the entire behavior of a widget (from its schema and internal model to the styles, clicking behavior, context menu and the dialog).</p><p>In CKEditor 5 the widget system was redesigned. Most of its responsibilities were taken over by the engine, some were extracted to a separate package (<a href="../../../api/widget.html"><code>@ckeditor/ckeditor5-widget</code></a>) and some have to be handled by other utils provided by CKEditor 5 framework.</p><p>CKEditor 5&#x2019;s implementation is, therefore, open for extensions and recomposition. You can choose those behaviors that you want (just like we did so far in this tutorial by defining a schema) and skip others or implement them by yourself.</p></div>
<p>The converters that we defined convert the model <code>&lt;simpleBox*&gt;</code> elements to plain <a href="../../../api/module_engine_view_containerelement-ContainerElement.html"><code>ContainerElement</code></a>s in the view (and back during upcasting).</p>
<p>We want to change this behavior a bit so the structure created in the editing view is enhanced with the <a href="../../../api/module_widget_utils.html#static-function-toWidget"><code>toWidget()</code></a> and <a href="../../../api/module_widget_utils.html#static-function-toWidgetEditable"><code>toWidgetEditable()</code></a> utils. We do not want to affect the data view, though. Therefore, we will need to define converters for the editing and data downcasting separately.</p>
<p>If you find the concept of downcasting and upcasting confusing, read the <a href="../architecture/editing-engine.html#conversion">introduction to conversion</a>.</p>
<p>Before we start coding, we need to install the <a href="../../../api/widget.html"><code>@ckeditor/ckeditor5-widget</code></a> package:</p>
<pre class="highlight"><code class>npm install --save @ckeditor/ckeditor5-widget
</code></pre>
<p>Now, let&#x2019;s revisit the <code>_defineConverters()</code> method that we defined earlier. We will use <a href="../../../api/module_engine_conversion_upcasthelpers-UpcastHelpers.html#function-elementToElement"><code>elementToElement()</code> upcast helper</a> and <a href="../../../api/module_engine_conversion_downcasthelpers-DowncastHelpers.html#function-elementToElement"><code>elementToElement()</code> downcast helper</a> instead of the two-way <code>elementToElement()</code> converter helper.</p>
<p>Additionally, we need to ensure that the <a href="../../../api/module_widget_widget-Widget.html"><code>Widget</code></a> plugin is loaded. If you omit it, the elements in the view will have all the classes (e.g. <code>ck-widget</code>) but there will be no &#x201C;behaviors&#x201D; loaded (e.g. clicking a widget will not select it).</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/simpleboxediting.js</span>

<span class="hljs-keyword">import</span> Plugin <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/plugin&apos;</span>;

<span class="hljs-comment">// ADDED 2 imports</span>
<span class="hljs-keyword">import</span> { toWidget, toWidgetEditable } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-widget/src/utils&apos;</span>;
<span class="hljs-keyword">import</span> Widget <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-widget/src/widget&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxEditing</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> requires() {                                                    <span class="hljs-comment">// ADDED</span>
        <span class="hljs-keyword">return</span> [ Widget ];
    }

    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxEditing#init() got called&apos;</span> );

        <span class="hljs-keyword">this</span>._defineSchema();
        <span class="hljs-keyword">this</span>._defineConverters();
    }

    _defineSchema() {
        <span class="hljs-comment">// ...</span>
    }

    _defineConverters() {                                                      <span class="hljs-comment">// MODIFIED</span>
        <span class="hljs-keyword">const</span> conversion = <span class="hljs-keyword">this</span>.editor.conversion;

        <span class="hljs-comment">// &lt;simpleBox&gt; converters</span>
        conversion.for( <span class="hljs-string">&apos;upcast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;section&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;dataDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;section&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;editingDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,
            <span class="hljs-attr">view</span>: <span class="hljs-function">(<span class="hljs-params"> modelElement, viewWriter </span>) =&gt;</span> {
                <span class="hljs-keyword">const</span> section = viewWriter.createContainerElement( <span class="hljs-string">&apos;section&apos;</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">&apos;simple-box&apos;</span> } );

                <span class="hljs-keyword">return</span> toWidget( section, viewWriter, { <span class="hljs-attr">label</span>: <span class="hljs-string">&apos;simple box widget&apos;</span> } );
            }
        } );

        <span class="hljs-comment">// &lt;simpleBoxTitle&gt; converters</span>
        conversion.for( <span class="hljs-string">&apos;upcast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;h1&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-title&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;dataDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;h1&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-title&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;editingDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>,
            <span class="hljs-attr">view</span>: <span class="hljs-function">(<span class="hljs-params"> modelElement, viewWriter </span>) =&gt;</span> {
                <span class="hljs-comment">// Note: we use a more specialized createEditableElement() method here.</span>
                <span class="hljs-keyword">const</span> h1 = viewWriter.createEditableElement( <span class="hljs-string">&apos;h1&apos;</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">&apos;simple-box-title&apos;</span> } );

                <span class="hljs-keyword">return</span> toWidgetEditable( h1, viewWriter );
            }
        } );

        <span class="hljs-comment">// &lt;simpleBoxDescription&gt; converters</span>
        conversion.for( <span class="hljs-string">&apos;upcast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;div&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-description&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;dataDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;div&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-description&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;editingDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>,
            <span class="hljs-attr">view</span>: <span class="hljs-function">(<span class="hljs-params"> modelElement, viewWriter </span>) =&gt;</span> {
                <span class="hljs-comment">// Note: we use a more specialized createEditableElement() method here.</span>
                <span class="hljs-keyword">const</span> div = viewWriter.createEditableElement( <span class="hljs-string">&apos;div&apos;</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">&apos;simple-box-description&apos;</span> } );

                <span class="hljs-keyword">return</span> toWidgetEditable( div, viewWriter );
            }
        } );
    }
}
</code></pre>
<div class="info-box notice"><p>As you can see, the code became much more verbose and far longer. This is because we used lower-level converters. We plan to provide more handy widget conversion utils in the future. Read more (and &#x1F44D;) in <a href="https://github.com/ckeditor/ckeditor5/issues/1228" target="_blank" rel="noopener">this ticket</a>.</p></div>
<h3 id="behavior-after-widgetizing-simple-box"><a class="headerlink" href="#behavior-after-widgetizing-simple-box">#</a> Behavior after &#x201C;widgetizing&#x201D; simple box</h3>
<p>You can rebuild your project now and see how your simple box plugin has changed.</p>
<p><a href="../../../assets/img/tutorial-implementing-a-widget-5.png" data-lightbox="true"><img src="../../../assets/img/tutorial-implementing-a-widget-5.png" alt="Screenshot of a widget&#x2019;s focus outline."></a></p>
<p>You should observe that:</p>
<ul>
<li>The <code>&lt;section&gt;</code>, <code>&lt;h1&gt;</code>, and <code>&lt;div&gt;</code> elements have the <code>contentEditable</code> attribute on them (plus some classes). This attribute tells the browser whether an element is considered &#x201C;editable&#x201D;. Passing element through <code>toWidget()</code> will make its content non-editable. Conversely, passing it through <code>toWidgetEditable()</code> will make its content editable again.</li>
<li>You can now click on the widget (the gray area) to select it. Once it is selected, it is easier to copy-paste it.</li>
<li>The widget and its nested editable regions react to hovering, selection, and focus (outline).</li>
</ul>
<p>In other words, the simple box instance became much more responsive.</p>
<p>Additionally, if you call <code>editor.getData()</code> you will get the same HTML as before &#x201C;widgetizing&#x201D; simple box. That&#x2019;s thanks to using <code>toWidget()</code> and <code>toNestedEditable()</code> only in the <code>editingDowncast</code> pipeline.</p>
<p>This is all that we need from the model and the view layers for now. In terms of &#x201C;editability&#x201D; and data input/output its fully functional. Let&#x2019;s now find a way to insert new simple boxes into the document!</p>
<h2 id="creating-a-command"><a class="headerlink" href="#creating-a-command">#</a> Creating a command</h2>
<p>A <a href="../architecture/core-editor-architecture.html#commands">command</a> is a combination of an action and a state. You can interact with most of the editor features by commands that they expose. This allows not only executing those features (e.g. bolding a fragment of text) but also checking if this action can be executed in the selection&#x2019;s current location as well as observing other state properties (such as whether the currently selected text is bolded).</p>
<p>In case of the simple box the situation is simple:</p>
<ul>
<li>we need an &#x201C;insert new simple box&#x201D; action,</li>
<li>and &#x201C;can we insert a new simple box here (at the current selection position)&#x201D;.</li>
</ul>
<p>Let&#x2019;s create a new file <code>insertsimpleboxcommand.js</code> in the <code>simplebox/</code> directory. We will use the <a href="../../../api/module_engine_model_model-Model.html#function-insertContent"><code>model.insertContent()</code></a> method which will be able to e.g. split a paragraph if you try to insert a simple box in the middle of it (which is not allowed by the schema.</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/insertsimpleboxcommand.js</span>

<span class="hljs-keyword">import</span> Command <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/command&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InsertSimpleBoxCommand</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span> </span>{
    execute() {
        <span class="hljs-keyword">this</span>.editor.model.change( <span class="hljs-function"><span class="hljs-params">writer</span> =&gt;</span> {
            <span class="hljs-comment">// Insert &lt;simpleBox&gt;*&lt;/simpleBox&gt; at the current selection position</span>
            <span class="hljs-comment">// in a way which will result in creating a valid model structure.</span>
            <span class="hljs-keyword">this</span>.editor.model.insertContent( createSimpleBox( writer ) );
        } );
    }

    refresh() {
        <span class="hljs-keyword">const</span> model = <span class="hljs-keyword">this</span>.editor.model;
        <span class="hljs-keyword">const</span> selection = model.document.selection;
        <span class="hljs-keyword">const</span> allowedIn = model.schema.findAllowedParent( selection.getFirstPosition(), <span class="hljs-string">&apos;simpleBox&apos;</span> );

        <span class="hljs-keyword">this</span>.isEnabled = allowedIn !== <span class="hljs-literal">null</span>;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSimpleBox</span>(<span class="hljs-params"> writer </span>) </span>{
    <span class="hljs-keyword">const</span> simpleBox = writer.createElement( <span class="hljs-string">&apos;simpleBox&apos;</span> );
    <span class="hljs-keyword">const</span> simpleBoxTitle = writer.createElement( <span class="hljs-string">&apos;simpleBoxTitle&apos;</span> );
    <span class="hljs-keyword">const</span> simpleBoxDescription = writer.createElement( <span class="hljs-string">&apos;simpleBoxDescription&apos;</span> );

    writer.append( simpleBoxTitle, simpleBox );
    writer.append( simpleBoxDescription, simpleBox );

    <span class="hljs-comment">// There must be at least one paragraph for the description to be editable.</span>
    <span class="hljs-comment">// See https://github.com/ckeditor/ckeditor5/issues/1464.</span>
    writer.appendElement( <span class="hljs-string">&apos;paragraph&apos;</span>, simpleBoxDescription );

    <span class="hljs-keyword">return</span> simpleBox;
}
</code></pre>
<p>Import the command and register it in the <code>SimpleBoxEditing</code> plugin:</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/simpleboxediting.js</span>

<span class="hljs-keyword">import</span> Plugin <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/plugin&apos;</span>;

<span class="hljs-keyword">import</span> { toWidget, toWidgetEditable } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-widget/src/utils&apos;</span>;
<span class="hljs-keyword">import</span> Widget <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-widget/src/widget&apos;</span>;

<span class="hljs-keyword">import</span> InsertSimpleBoxCommand <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./insertsimpleboxcommand&apos;</span>;                 <span class="hljs-comment">// ADDED</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxEditing</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> requires() {
        <span class="hljs-keyword">return</span> [ Widget ];
    }

    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxEditing#init() got called&apos;</span> );

        <span class="hljs-keyword">this</span>._defineSchema();
        <span class="hljs-keyword">this</span>._defineConverters();

        <span class="hljs-comment">// ADDED</span>
        <span class="hljs-keyword">this</span>.editor.commands.add( <span class="hljs-string">&apos;insertSimpleBox&apos;</span>, <span class="hljs-keyword">new</span> InsertSimpleBoxCommand( <span class="hljs-keyword">this</span>.editor ) );
    }

    _defineSchema() {
        <span class="hljs-comment">// ...</span>
    }

    _defineConverters() {
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p>You can now execute this command in order to insert a new simple box. Calling:</p>
<pre class="highlight"><code class="js">editor.execute( <span class="hljs-string">&apos;insertSimpleBox&apos;</span> );
</code></pre>
<p>Should result in:</p>
<p><a href="../../../assets/img/tutorial-implementing-a-widget-6.png" data-lightbox="true"><img src="../../../assets/img/tutorial-implementing-a-widget-6.png" alt="Screenshot of a simple box instance inserted at the beginning of the editor content."></a></p>
<p>You can also try inspecting the <code>isEnabled</code> property value (or just checking it in CKEditor 5 inspector):</p>
<pre class="highlight"><code class="js"><span class="hljs-built_in">console</span>.log( editor.commands.get( <span class="hljs-string">&apos;insertSimpleBox&apos;</span> ).isEnabled );
</code></pre>
<p>It is always <code>true</code> except when the selection is in one place &#x2014; in other simple box&#x2019;s title. You can also observe that executing the command when the selection is in that place takes no effect.</p>
<p>Let&#x2019;s change one more thing before we will move forward &#x2014; let&#x2019;s disallow <code>simpleBox</code> inside <code>simpleBoxDescription</code> too. This can be done by <a href="../../../api/module_engine_model_schema-Schema.html#function-addChildCheck">defining a custom child check</a>:</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/simpleboxediting.js</span>

<span class="hljs-comment">// ... imports</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxEditing</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> requires() {
        <span class="hljs-keyword">return</span> [ Widget ];
    }

    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxEditing#init() got called&apos;</span> );

        <span class="hljs-keyword">this</span>._defineSchema();
        <span class="hljs-keyword">this</span>._defineConverters();

        <span class="hljs-keyword">this</span>.editor.commands.add( <span class="hljs-string">&apos;insertSimpleBox&apos;</span>, <span class="hljs-keyword">new</span> InsertSimpleBoxCommand( <span class="hljs-keyword">this</span>.editor ) );
    }

    _defineSchema() {
        <span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">this</span>.editor.model.schema;

        schema.register( <span class="hljs-string">&apos;simpleBox&apos;</span>, {
            <span class="hljs-comment">// Behaves like a self-contained object (e.g. an image).</span>
            isObject: <span class="hljs-literal">true</span>,

            <span class="hljs-comment">// Allow in places where other blocks are allowed (e.g. directly in the root).</span>
            allowWhere: <span class="hljs-string">&apos;$block&apos;</span>
        } );

        schema.register( <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>, {
            <span class="hljs-comment">// Cannot be split or left by the caret.</span>
            isLimit: <span class="hljs-literal">true</span>,

            <span class="hljs-attr">allowIn</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,

            <span class="hljs-comment">// Allow content which is allowed in blocks (i.e. text with attributes).</span>
            allowContentOf: <span class="hljs-string">&apos;$block&apos;</span>
        } );

        schema.register( <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>, {
            <span class="hljs-comment">// Cannot be split or left by the caret.</span>
            isLimit: <span class="hljs-literal">true</span>,

            <span class="hljs-attr">allowIn</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,

            <span class="hljs-comment">// Allow content which is allowed in the root (e.g. paragraphs).</span>
            allowContentOf: <span class="hljs-string">&apos;$root&apos;</span>
        } );

        <span class="hljs-comment">// ADDED</span>
        schema.addChildCheck( <span class="hljs-function">(<span class="hljs-params"> context, childDefinition </span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> ( context.endsWith( <span class="hljs-string">&apos;simpleBoxDescription&apos;</span> ) &amp;&amp; childDefinition.name == <span class="hljs-string">&apos;simpleBox&apos;</span> ) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        } );
    }

    _defineConverters() {
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p>Now, the command should be disabled also when the selection is inside the description of another simple box instance.</p>
<h2 id="creating-a-button"><a class="headerlink" href="#creating-a-button">#</a> Creating a button</h2>
<p>It is time to allow editor users to insert the widget into the content. The best way to do that is through a UI button in the toolbar. You can quickly create one using the <a href="../../../api/module_ui_button_buttonview-ButtonView.html"><code>ButtonView</code></a> class brought by the <a href="../architecture/ui-library.html">UI framework</a> of CKEditor 5.</p>
<p>The button should execute the <a href="#creating-a-command">command</a> when clicked and become inactive if the widget cannot be inserted in some particular position of the selection (<a href="#defining-the-schema">as defined in the schema</a>).</p>
<p>Let us see what it looks like in practice and extend the <code>SimpleBoxUI</code> plugin <a href="#plugin-structure">created earlier</a>:</p>
<pre class="highlight"><code class="js"><span class="hljs-comment">// simplebox/simpleboxui.js</span>

<span class="hljs-keyword">import</span> ButtonView <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-ui/src/button/buttonview&apos;</span>;
<span class="hljs-keyword">import</span> Plugin <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/plugin&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxUI</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxUI#init() got called&apos;</span> );

        <span class="hljs-keyword">const</span> editor = <span class="hljs-keyword">this</span>.editor;
        <span class="hljs-keyword">const</span> t = editor.t;

        <span class="hljs-comment">// The &quot;simpleBox&quot; button must be registered among UI components of the editor</span>
        <span class="hljs-comment">// to be displayed in the toolbar.</span>
        editor.ui.componentFactory.add( <span class="hljs-string">&apos;simpleBox&apos;</span>, locale =&gt; {
            <span class="hljs-comment">// The state of the button will be bound to the widget command.</span>
            <span class="hljs-keyword">const</span> command = editor.commands.get( <span class="hljs-string">&apos;insertSimpleBox&apos;</span> );

            <span class="hljs-comment">// The button will be an instance of ButtonView.</span>
            <span class="hljs-keyword">const</span> buttonView = <span class="hljs-keyword">new</span> ButtonView( locale );

            buttonView.set( {
                <span class="hljs-comment">// The t() function helps localize the editor. All strings enclosed in t() can be</span>
                <span class="hljs-comment">// translated and change when the language of the editor changes.</span>
                label: t( <span class="hljs-string">&apos;Simple Box&apos;</span> ),
                <span class="hljs-attr">withText</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">tooltip</span>: <span class="hljs-literal">true</span>
            } );

            <span class="hljs-comment">// Bind the state of the button to the command.</span>
            buttonView.bind( <span class="hljs-string">&apos;isOn&apos;</span>, <span class="hljs-string">&apos;isEnabled&apos;</span> ).to( command, <span class="hljs-string">&apos;value&apos;</span>, <span class="hljs-string">&apos;isEnabled&apos;</span> );

            <span class="hljs-comment">// Execute the command when the button is clicked (executed).</span>
            <span class="hljs-keyword">this</span>.listenTo( buttonView, <span class="hljs-string">&apos;execute&apos;</span>, () =&gt; editor.execute( <span class="hljs-string">&apos;insertSimpleBox&apos;</span> ) );

            <span class="hljs-keyword">return</span> buttonView;
        } );
    }
}
</code></pre>
<p>The last thing you need to do is tell the editor to display the button in the toolbar. To do that, you will need to slightly modify the code that runs the editor instance and include the button in the <a href="../../../api/module_core_editor_editorconfig-EditorConfig.html#member-toolbar">toolbar configuration</a>:</p>
<pre class="highlight"><code class="js">ClassicEditor
    .create( <span class="hljs-built_in">document</span>.querySelector( <span class="hljs-string">&apos;#editor&apos;</span> ), {
        <span class="hljs-attr">plugins</span>: [ Essentials, Paragraph, Heading, List, Bold, Italic, SimpleBox ],
        <span class="hljs-comment">// Insert the &quot;simpleBox&quot; to the editor toolbar.</span>
        toolbar: [ <span class="hljs-string">&apos;heading&apos;</span>, <span class="hljs-string">&apos;bold&apos;</span>, <span class="hljs-string">&apos;italic&apos;</span>, <span class="hljs-string">&apos;numberedList&apos;</span>, <span class="hljs-string">&apos;bulletedList&apos;</span>, <span class="hljs-string">&apos;simpleBox&apos;</span> ]
    } )
    .then( <span class="hljs-function"><span class="hljs-params">editor</span> =&gt;</span> {
        <span class="hljs-comment">// ...</span>
    } )
    .catch( <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-comment">// ...</span>
    } );
</code></pre>
<p>Refresh the web page and try it yourself:</p>
<p><a href="../../../assets/img/tutorial-implementing-a-widget-7.png" data-lightbox="true"><img src="../../../assets/img/tutorial-implementing-a-widget-7.png" alt="Screenshot of the simple box widget being inserted using the toolbar button."></a></p>
<h2 id="demo"><a class="headerlink" href="#demo">#</a> Demo</h2>
<p>You can see the block widget implementation in action in the editor below. You can also check out the full <a href="#full-source-code">source code</a> of this tutorial if you want to develop your own block widgets.</p>
<div class="live-snippet"><style>
	.simple-box {
		padding: 10px;
		margin: 1em 0;

		background: rgba( 0, 0, 0, 0.1 );
		border: solid 1px hsl(0, 0%, 77%);
		border-radius: 2px;
	}

	.simple-box-title, .simple-box-description {
		padding: 10px;
		margin: 0;

		background: #FFF;
		border: solid 1px hsl(0, 0%, 77%);
	}

	.simple-box-title {
		margin-bottom: 10px;
	}
</style>

<div id="snippet-block-widget">
	<p>This is a simple box:</p>

	<section class="simple-box">
		<h1 class="simple-box-title">Box title</h1>
		<div class="simple-box-description">
			<p>The description goes here.</p>
			<ul>
				<li>It can contain lists,</li>
				<li>and other block elements like headings.</li>
			</ul>
		</div>
	</section>
</div>
</div>
<h2 id="full-source-code"><a class="headerlink" href="#full-source-code">#</a> Full source code</h2>
<p>The following code contains a complete implementation of the <code>SimpleBox</code> plugin (and all its dependencies) and the code to run the editor. You can paste it into the <a href="#plugin-structure"><code>app.js</code></a> file and it will run out&#x2013;of&#x2013;the&#x2013;box:</p>
<pre class="highlight"><code class="js"><span class="hljs-keyword">import</span> ClassicEditor <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-editor-classic/src/classiceditor&apos;</span>;
<span class="hljs-keyword">import</span> Essentials <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-essentials/src/essentials&apos;</span>;
<span class="hljs-keyword">import</span> Bold <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-basic-styles/src/bold&apos;</span>;
<span class="hljs-keyword">import</span> Italic <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-basic-styles/src/italic&apos;</span>;
<span class="hljs-keyword">import</span> Heading <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-heading/src/heading&apos;</span>;
<span class="hljs-keyword">import</span> List <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-list/src/list&apos;</span>;
<span class="hljs-keyword">import</span> Paragraph <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-paragraph/src/paragraph&apos;</span>;

<span class="hljs-keyword">import</span> Plugin <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/plugin&apos;</span>;
<span class="hljs-keyword">import</span> { toWidget, toWidgetEditable } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-widget/src/utils&apos;</span>;
<span class="hljs-keyword">import</span> Widget <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-widget/src/widget&apos;</span>;
<span class="hljs-keyword">import</span> Command <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-core/src/command&apos;</span>;
<span class="hljs-keyword">import</span> ButtonView <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ckeditor/ckeditor5-ui/src/button/buttonview&apos;</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBox</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> requires() {
        <span class="hljs-keyword">return</span> [ SimpleBoxEditing, SimpleBoxUI ];
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxUI</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxUI#init() got called&apos;</span> );

        <span class="hljs-keyword">const</span> editor = <span class="hljs-keyword">this</span>.editor;
        <span class="hljs-keyword">const</span> t = editor.t;

        <span class="hljs-comment">// The &quot;simpleBox&quot; button must be registered among UI components of the editor</span>
        <span class="hljs-comment">// to be displayed in the toolbar.</span>
        editor.ui.componentFactory.add( <span class="hljs-string">&apos;simpleBox&apos;</span>, locale =&gt; {
            <span class="hljs-comment">// The state of the button will be bound to the widget command.</span>
            <span class="hljs-keyword">const</span> command = editor.commands.get( <span class="hljs-string">&apos;insertSimpleBox&apos;</span> );

            <span class="hljs-comment">// The button will be an instance of ButtonView.</span>
            <span class="hljs-keyword">const</span> buttonView = <span class="hljs-keyword">new</span> ButtonView( locale );

            buttonView.set( {
                <span class="hljs-comment">// The t() function helps localize the editor. All strings enclosed in t() can be</span>
                <span class="hljs-comment">// translated and change when the language of the editor changes.</span>
                label: t( <span class="hljs-string">&apos;Simple Box&apos;</span> ),
                <span class="hljs-attr">withText</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">tooltip</span>: <span class="hljs-literal">true</span>
            } );

            <span class="hljs-comment">// Bind the state of the button to the command.</span>
            buttonView.bind( <span class="hljs-string">&apos;isOn&apos;</span>, <span class="hljs-string">&apos;isEnabled&apos;</span> ).to( command, <span class="hljs-string">&apos;value&apos;</span>, <span class="hljs-string">&apos;isEnabled&apos;</span> );

            <span class="hljs-comment">// Execute the command when the button is clicked (executed).</span>
            <span class="hljs-keyword">this</span>.listenTo( buttonView, <span class="hljs-string">&apos;execute&apos;</span>, () =&gt; editor.execute( <span class="hljs-string">&apos;insertSimpleBox&apos;</span> ) );

            <span class="hljs-keyword">return</span> buttonView;
        } );
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleBoxEditing</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Plugin</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> requires() {
        <span class="hljs-keyword">return</span> [ Widget ];
    }

    init() {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;SimpleBoxEditing#init() got called&apos;</span> );

        <span class="hljs-keyword">this</span>._defineSchema();
        <span class="hljs-keyword">this</span>._defineConverters();

        <span class="hljs-keyword">this</span>.editor.commands.add( <span class="hljs-string">&apos;insertSimpleBox&apos;</span>, <span class="hljs-keyword">new</span> InsertSimpleBoxCommand( <span class="hljs-keyword">this</span>.editor ) );
    }

    _defineSchema() {
        <span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">this</span>.editor.model.schema;

        schema.register( <span class="hljs-string">&apos;simpleBox&apos;</span>, {
            <span class="hljs-comment">// Behaves like a self-contained object (e.g. an image).</span>
            isObject: <span class="hljs-literal">true</span>,

            <span class="hljs-comment">// Allow in places where other blocks are allowed (e.g. directly in the root).</span>
            allowWhere: <span class="hljs-string">&apos;$block&apos;</span>
        } );

        schema.register( <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>, {
            <span class="hljs-comment">// Cannot be split or left by the caret.</span>
            isLimit: <span class="hljs-literal">true</span>,

            <span class="hljs-attr">allowIn</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,

            <span class="hljs-comment">// Allow content which is allowed in blocks (i.e. text with attributes).</span>
            allowContentOf: <span class="hljs-string">&apos;$block&apos;</span>
        } );

        schema.register( <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>, {
            <span class="hljs-comment">// Cannot be split or left by the caret.</span>
            isLimit: <span class="hljs-literal">true</span>,

            <span class="hljs-attr">allowIn</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,

            <span class="hljs-comment">// Allow content which is allowed in the root (e.g. paragraphs).</span>
            allowContentOf: <span class="hljs-string">&apos;$root&apos;</span>
        } );

        schema.addChildCheck( <span class="hljs-function">(<span class="hljs-params"> context, childDefinition </span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> ( context.endsWith( <span class="hljs-string">&apos;simpleBoxDescription&apos;</span> ) &amp;&amp; childDefinition.name == <span class="hljs-string">&apos;simpleBox&apos;</span> ) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        } );
    }

    _defineConverters() {
        <span class="hljs-keyword">const</span> conversion = <span class="hljs-keyword">this</span>.editor.conversion;

        <span class="hljs-comment">// &lt;simpleBox&gt; converters</span>
        conversion.for( <span class="hljs-string">&apos;upcast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;section&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;dataDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;section&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;editingDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBox&apos;</span>,
            <span class="hljs-attr">view</span>: <span class="hljs-function">(<span class="hljs-params"> modelElement, viewWriter </span>) =&gt;</span> {
                <span class="hljs-keyword">const</span> section = viewWriter.createContainerElement( <span class="hljs-string">&apos;section&apos;</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">&apos;simple-box&apos;</span> } );

                <span class="hljs-keyword">return</span> toWidget( section, viewWriter, { <span class="hljs-attr">label</span>: <span class="hljs-string">&apos;simple box widget&apos;</span> } );
            }
        } );

        <span class="hljs-comment">// &lt;simpleBoxTitle&gt; converters</span>
        conversion.for( <span class="hljs-string">&apos;upcast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;h1&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-title&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;dataDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;h1&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-title&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;editingDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxTitle&apos;</span>,
            <span class="hljs-attr">view</span>: <span class="hljs-function">(<span class="hljs-params"> modelElement, viewWriter </span>) =&gt;</span> {
                <span class="hljs-comment">// Note: we use a more specialized createEditableElement() method here.</span>
                <span class="hljs-keyword">const</span> h1 = viewWriter.createEditableElement( <span class="hljs-string">&apos;h1&apos;</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">&apos;simple-box-title&apos;</span> } );

                <span class="hljs-keyword">return</span> toWidgetEditable( h1, viewWriter );
            }
        } );

        <span class="hljs-comment">// &lt;simpleBoxDescription&gt; converters</span>
        conversion.for( <span class="hljs-string">&apos;upcast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;div&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-description&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;dataDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>,
            <span class="hljs-attr">view</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;div&apos;</span>,
                <span class="hljs-attr">classes</span>: <span class="hljs-string">&apos;simple-box-description&apos;</span>
            }
        } );
        conversion.for( <span class="hljs-string">&apos;editingDowncast&apos;</span> ).elementToElement( {
            <span class="hljs-attr">model</span>: <span class="hljs-string">&apos;simpleBoxDescription&apos;</span>,
            <span class="hljs-attr">view</span>: <span class="hljs-function">(<span class="hljs-params"> modelElement, viewWriter </span>) =&gt;</span> {
                <span class="hljs-comment">// Note: we use a more specialized createEditableElement() method here.</span>
                <span class="hljs-keyword">const</span> div = viewWriter.createEditableElement( <span class="hljs-string">&apos;div&apos;</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">&apos;simple-box-description&apos;</span> } );

                <span class="hljs-keyword">return</span> toWidgetEditable( div, viewWriter );
            }
        } );
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InsertSimpleBoxCommand</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span> </span>{
    execute() {
        <span class="hljs-keyword">this</span>.editor.model.change( <span class="hljs-function"><span class="hljs-params">writer</span> =&gt;</span> {
            <span class="hljs-comment">// Insert &lt;simpleBox&gt;*&lt;/simpleBox&gt; at the current selection position</span>
            <span class="hljs-comment">// in a way which will result in creating a valid model structure.</span>
            <span class="hljs-keyword">this</span>.editor.model.insertContent( createSimpleBox( writer ) );
        } );
    }

    refresh() {
        <span class="hljs-keyword">const</span> model = <span class="hljs-keyword">this</span>.editor.model;
        <span class="hljs-keyword">const</span> selection = model.document.selection;
        <span class="hljs-keyword">const</span> allowedIn = model.schema.findAllowedParent( selection.getFirstPosition(), <span class="hljs-string">&apos;simpleBox&apos;</span> );

        <span class="hljs-keyword">this</span>.isEnabled = allowedIn !== <span class="hljs-literal">null</span>;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSimpleBox</span>(<span class="hljs-params"> writer </span>) </span>{
    <span class="hljs-keyword">const</span> simpleBox = writer.createElement( <span class="hljs-string">&apos;simpleBox&apos;</span> );
    <span class="hljs-keyword">const</span> simpleBoxTitle = writer.createElement( <span class="hljs-string">&apos;simpleBoxTitle&apos;</span> );
    <span class="hljs-keyword">const</span> simpleBoxDescription = writer.createElement( <span class="hljs-string">&apos;simpleBoxDescription&apos;</span> );

    writer.append( simpleBoxTitle, simpleBox );
    writer.append( simpleBoxDescription, simpleBox );

    <span class="hljs-comment">// There must be at least one paragraph for the description to be editable.</span>
    <span class="hljs-comment">// See https://github.com/ckeditor/ckeditor5/issues/1464.</span>
    writer.appendElement( <span class="hljs-string">&apos;paragraph&apos;</span>, simpleBoxDescription );

    <span class="hljs-keyword">return</span> simpleBox;
}

ClassicEditor
    .create( <span class="hljs-built_in">document</span>.querySelector( <span class="hljs-string">&apos;#editor&apos;</span> ), {
        <span class="hljs-attr">plugins</span>: [ Essentials, Bold, Italic, Heading, List, Paragraph, SimpleBox ],
        <span class="hljs-attr">toolbar</span>: [ <span class="hljs-string">&apos;heading&apos;</span>, <span class="hljs-string">&apos;|&apos;</span>, <span class="hljs-string">&apos;bold&apos;</span>, <span class="hljs-string">&apos;italic&apos;</span>, <span class="hljs-string">&apos;numberedList&apos;</span>, <span class="hljs-string">&apos;bulletedList&apos;</span>, <span class="hljs-string">&apos;simpleBox&apos;</span> ],
    } )
    .then( <span class="hljs-function"><span class="hljs-params">editor</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log( <span class="hljs-string">&apos;Editor was initialized&apos;</span>, editor );

        <span class="hljs-built_in">window</span>.editor = editor;
    } )
    .catch( <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.error( err.stack );
    } );
</code></pre>

        </div>
      </section>
      <div class="side-navigation">
        <div class="side-navigation__wrapper">
          <nav class="side-navigation__inner">
            <ul class="tree guide-tree">
                          <li>
                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Guides</span></div>
                            <ul class="tree__item-nested-list">
                                    <li><a href="../overview.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Overview</span></div></a></li>
                                    <li><a href="../quick-start.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Quick start</span></div></a></li>
                                    <li><a href="../creating-simple-plugin.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Creating a simple plugin</span></div></a></li>
                                    <li><a href="../development-tools.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Development tools</span></div></a></li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Architecture</span></div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../architecture/intro.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Introduction</span></div></a></li>
                                              <li><a href="../architecture/core-editor-architecture.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Core editor architecture</span></div></a></li>
                                              <li><a href="../architecture/editing-engine.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Editing engine</span></div></a></li>
                                              <li><a href="../architecture/ui-library.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">UI library</span></div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Tutorials</span></div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href>
                                                  <div class="tree__item__wrapper tree__item__wrapper--active"><span class="tree__item--guide tree__item__text">Implementing a block widget</span></div></a></li>
                                              <li><a href="implementing-an-inline-widget.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Implementing an inline widget</span></div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Deep dive</span></div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../deep-dive/clipboard.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Clipboard</span></div></a></li>
                                              <li><a href="../deep-dive/upload-adapter.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Custom upload adapter</span></div></a></li>
                                              <li><a href="../deep-dive/observables.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Observables</span></div></a></li>
                                              <li><a href="../deep-dive/schema.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Schema</span></div></a></li>
                                              <li>
                                                <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">User interface</span></div>
                                                <ul class="tree__item-nested-list">
                                                        <li><a href="../deep-dive/ui/theme-customization.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Theme customization</span></div></a></li>
                                                        <li><a href="../deep-dive/ui/external-ui.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Thirdâ€“party UI</span></div></a></li>
                                                        <li><a href="../deep-dive/ui/document-editor.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Document editor</span></div></a></li>
                                                        <li><a href="../deep-dive/ui/custom-editor-creator.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Creating custom editor</span></div></a></li>
                                                </ul>
                                              </li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Contributing</span></div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../contributing/contributing.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Contributing</span></div></a></li>
                                              <li><a href="../contributing/development-environment.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Development environment</span></div></a></li>
                                              <li><a href="../contributing/testing-environment.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Testing environment</span></div></a></li>
                                              <li><a href="../contributing/git-commit-message-convention.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Git commit message convention</span></div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Support</span></div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../support/browser-compatibility.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Browser compatibility</span></div></a></li>
                                              <li><a href="../support/license-and-legal.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">License and legal</span></div></a></li>
                                              <li><a href="../support/getting-support.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Getting support</span></div></a></li>
                                              <li><a href="../support/reporting-issues.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Reporting issues</span></div></a></li>
                                              <li><a href="../support/error-codes.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Error codes</span></div></a></li>
                                      </ul>
                                    </li>
                            </ul>
                          </li>
            </ul>
          </nav>
        </div>
      </div>
    </main>
    <footer class="footer footer--bordered">
      <p>&copy; 2003-2019 <a href="http://cksource.com">CKSource</a>. All rights reserved.</p>
    </footer>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
docsearch({
apiKey:'fc463c26455365ad403d5ec51796cd73',indexName:'ckeditor_nightly',inputSelector:'#docsearch_input',algoliaOptions:{hitsPerPage:250,attributesToRetrieve:'*',facetFilters:['tags: ckeditor5']},
transformData: function( hits ) {var sortingFn = function( a, b ) {a.custom_ranking = a.custom_ranking || 0;b.custom_ranking = b.custom_ranking || 0;if ( a.custom_ranking === b.custom_ranking ) return a.index - b.index;if ( a.custom_ranking > b.custom_ranking ) return -1;if ( a.custom_ranking < b.custom_ranking ) return 1;};var result = [];var tags = [ 'builds', 'framework', 'examples', 'features', 'api' ];var hitsGrouped = { api: [] };hitsGrouped[ 'framework' ] = hits.filter( function( h ) {return h.tags.includes( 'framework' );} ).slice( 0, 7 ).map( function( item, idx ) {item.index = idx;return item;} ).sort( sortingFn );tags.forEach( function( tag ) {if ( tag !== 'framework' ) {hitsGrouped[ tag ] = hits.filter( function( h ) {return h.tags.includes( tag );} ).slice( 0, 10 ).map( function( item, idx ) {item.index = idx;return item;} ).sort( sortingFn ).slice( 0, 3 );}} );var apiSearchHits = [];if ( window.apiSearch ) apiSearchHits = window.apiSearch();hitsGrouped.api = hitsGrouped.api.filter( function( h ) {var isDuplicated = false;for ( var i = 0; i < apiSearchHits.length; i++ ) {if ( h.url.includes( apiSearchHits[ i ].urlShort ) ) {isDuplicated = true;break;}}return !isDuplicated;} );hitsGrouped.api = ( apiSearchHits || [] ).concat( hitsGrouped.api );result = result.concat( hitsGrouped[ 'framework' ] );tags.forEach( function( tag ) {if ( tag !== 'framework' ) result = result.concat( hitsGrouped[ tag ].slice( 0, 4 ) );} );return result;}
});
</script>
    <script src="../../../assets/snippet.js"></script>
    <script src="../../../snippets/framework/tutorials/block-widget/snippet.js"></script>
  </body>
</html>